#summary How to run Deployer.
#labels Phase-Deploy

= How to run =

== Pre-requirements ==

You need to have installed SVN command line tool on your machine. You can install [http://www.sliksvn.com/en/download Slik SVN] or similar distribution.

Note: svn should also be in the search path of the OS which you are using.

== General information ==
Tool is build from two components.

*First component* `org.pomizer.application.Deployer` is used for deployment of the changes on the server. As command line parameter you should provide full path to configuration file.


Component will create backup folder where all files would be copied before changes will be applied. Also changeset file will be created with listed file in the backup folder and their original path.

*Second component* `org.pomizer.application.Revertor` is used to revert all changes done by Deployer. As command line parameter you should provide full path to configuration file.


This component will copy all files from backup folder to original location based on the changeset file. After this changeset file will be deleted as well as copies of the original files.

== To run application you can use following approach ==

  * Download source code of the tool
  * execute 

`mvn compile`

  * run any from two components using command line similar to following

`mvn exec:java -Dexec.mainClass="org.pomizer.application.Deploy" -Dexec.args="c:\deployer.project"`


== Configuration file ==

Configuration is presented in the form of the XML document with the following structure

<code language="xml">
<deployer>

   <settings>

      <use_index>true</use_index>

   </settings>
   
   <index>C:\Projects\MyProject\index\full_jars_index.dat</index>

   <project path="C:\Projects\MyFirstProject">

       <settings>

         <use_index>true</use_index>

       </settings>

       <sources path="src\main\java" output="target\classes"/>

       <resources path="static_content\sample\jsps">
          <target>\\server\webserver\home\sample\jsps</target> 
       </resources>
        
   </project>

   <project path="C:\Projects\MySecondProject">

       <sources path="src\main\java" output="target\classes">

          <target>\\server\webserver\webapps\my-second-project.war\WEB-INF\lib\common.jar</target>

       </sources>
        
   </project>

   <copy path="C:\Projects\MyThirdProject\output\sample.html">

      <target>\\server\webserver\home\sample\html\sample.html</target>

   </copy>



   <!-- Call JMX job at the end of the deployment -->

   <call_url><![CDATA[http://admin:password@server.com:8080/jmx-console/HtmlAdaptor?action=invokeOp&name=web.server&methodIndex=10]]></call_url>

   <!-- Call command line in case if folder was updated -->

   <command updated_path="\\server\webserver\lib\" run="c:\tools\Sysinternals\pskill.exe \\server webserver.exe"/>

</deployer>
</code>